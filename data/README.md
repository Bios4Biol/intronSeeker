Here is a description of the different files and directories available in data/.

Tests files for intronSeeker command lines description
------------------------------------------------------
Inputs and outputs files used in intronSeeker command lines description (in README file) are available in data/Reduced_real_dataset directory.

Description of the data presented in paper.
-------------------------------------------
All files are available in data/Graphics.

# Table "Searching retained introns in public datasets"
---------------------------------------------
intronSeeker command lines, data source and HTML reports are available in data/REAL_DATA/

# Graphics "Setting default detection parameters"
------------------------------------
These graphics can be used to analyse detection parameters and setting default.

##### Graph A/ Coverage impact on detection.

Increasing the coverage allows to quickly lose false candidates with a very limited impact on the number of true candidates (Arabidopsis thaliana data, powerlow abundance).

data/Graphics/PW_cat_depth_False_candidats_bySample.csv is the concatenation of 10 tests files (one by sample) depth_False_candidats.csv generated by data/Graphics/complete_candidat_file.sh .

Script to generate this graphic:

```
#!/usr/bin/env python3
import os
import subprocess
import pandas as pd
import re
import statsmodels
import plotly.express as px
import plotly.graph_objects as go
from plotly.subplots import make_subplots

df_plot = pd.read_csv('data/PW_cat_depth_False_candidats_bySample.csv', sep=',')

layout = go.Layout() 
y_false=df_plot['False']
x_false=df_plot.index
	
fig=go.Figure(layout=layout) 
fig.add_trace(go.Box(x=df_plot["Cov"], y=df_plot["False"],  fillcolor ='rgb(241,90,96)', line_color='rgb(241,90,96)', name='Nb false'))
                    
fig.update_layout(boxmode='group', showlegend=True, paper_bgcolor='rgba(0,0,0,0)',
    plot_bgcolor='rgba(0,0,0,0)', font=dict(
        family="sans-serif",
        size=14), legend_font_size=14, xaxis=dict(
        title="Coverage", range=(0, 10)
    ),
    yaxis=dict(
        title="Nb false candidates"
    ))

# Legend position
fig.update_layout(legend=dict(
    orientation="v",
    yanchor="bottom",
    y=1.02,
    xanchor="right",
    x=1
    ))
    
fig.update_layout( yaxis=dict(
        autorange=True,
        showgrid=True,
        zeroline=True,
        dtick=5,
        gridcolor='rgb(211,211,211)',
        gridwidth=1,
        zerolinecolor='rgb(211,211,211)',
        zerolinewidth=2,
    ),
     paper_bgcolor='rgb(255,255,255)',
     plot_bgcolor='rgb(255,255,255)')

# Save plot     
if not os.path.exists("images"):
    os.mkdir("images")
fig.write_image("images/nb_false_by_coverage_PW_10samples.svg")
fig.write_html("images/nb_false_by_coverage_PW_10samples.html")
```

##### Graph B/ Filter candidates on border improve detection.

DPratio = DPin/(DPbefore+DPafter)

Input file 'data/Graphics/cat_pw_candidates.Cglen.intron.Cdlen.DPratio.RI.JC.csv' is used for B, C and D graphs.
Input file 'cat_pw_candidates.Cglen.intron.Cdlen.DPratio.RI.JC.csv' is the concatenation of 10 files (1 par sample) candidates.Cglen.intron.Cdlen.DPratio.RI.JC.csv, generated by data/Graphics/complete_candidat_file.sh .

Script to generate this graphic:

```
#!/usr/bin/env python3

import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd
import os

sns.set_theme(style="whitegrid")
df = pd.read_csv('data/cat_pw_candidates.Cglen.intron.Cdlen.DPratio.RI.JC.csv', sep=',')

# Colors list
colors_list=['#F16051CC','#5a9bd4CC']

# Border impact
ax= sns.violinplot(data=df, x="Critere_DP", y="DPratio", hue="Candidat", split=True, inner="quart", linewidth=1, palette=colors_list, legend = False, width=0.9)
sns.despine(left=True)
ax.set_xlabel("Border impact")
ax.set_ylabel("Counts")
ax.legend([],[], frameon=False)


# Plot visualisation
if not os.path.exists("images"):
    os.mkdir("images")
plt.savefig("images/PW_violin_DP_10samples.svg")
```

##### Graph C/ Filter candidates on candidat length.

Script to generate this graphic:

```
#!/usr/bin/env python3

import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd
import os

sns.set_theme(style="whitegrid")
df = pd.read_csv('data/cat_pw_candidates.Cglen.intron.Cdlen.DPratio.RI.JC.csv', sep=',')

# Colors list
colors_list=['#F16051CC','#5a9bd4']

# Select len impact
ax=sns.violinplot(data=df, x="Critere_lCd", y="lCd", hue="Candidat", split=True, inner="quart", linewidth=1, palette=colors_list, width=0.9)
sns.despine(left=True)
ax.set_xlabel("Candidat length")
ax.set_ylabel("Counts")
ax.legend([],[], frameon=False)

# Plot visualisation
if not os.path.exists("images"):
    os.mkdir("images")
plt.savefig("images/PW_violin_lCd_10samples.svg")
```

##### Graph D/ Filter candidates on retained intron ratio.

Retained intron ratio = (len contig / len candidat)

Script to generate this graphic:

```
#!/usr/bin/env python3

import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd
import os

sns.set_theme(style="whitegrid")
df = pd.read_csv('data/cat_pw_candidates.Cglen.intron.Cdlen.DPratio.RI.JC.csv', sep=',')

# Colors list
colors_list=['#F16051','#5a9bd4']

# Draw a nested violinplot and split the violins for easier comparison
ax=sns.violinplot(data=df, x="Critere_RI", y="RI", hue="Candidat", split=True, inner="quart", linewidth=1, palette=colors_list, legend = False)
sns.despine(left=True)
ax.set_xlabel("Candidat length/Contig length")
ax.set_ylabel("Counts")
ax.legend([],[], frameon=False)

# Plot visualisation
if not os.path.exists("images"):
    os.mkdir("images")
plt.savefig("images/PW_violin_RI_10samples.svg")
```